#!/usr/bin/env bash

bg_solid_bar='/home/herbort/Nextcloud/Fondos de pantalla/nord_shibuya_polybar_36_solid.png'
bg_transparent_bar='/home/herbort/Nextcloud/Fondos de pantalla/nord_shibuya_polybar_36.png'

bspc subscribe node_add node_remove node_transfer node_flag node_state desktop_focus desktop_layout | while read; do
    window_count=$(bspc query -N -n .!hidden.tiled.local.window | wc -l)
    layout="$(bspc query -T -d | jq --raw-output '.layout')"

    if [[ $window_count -ge 1 ]] && [[ "$layout" == "monocle" ]]; then
        feh --no-fehbg --bg-tile --image-bg '#2E3440' "$bg_solid_bar"
    else
        feh --no-fehbg --bg-tile --image-bg '#2E3440' "$bg_transparent_bar"
    fi
done
